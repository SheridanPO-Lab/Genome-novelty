# Genome-novelty
Calculates novelty of a genome at different taxonomic levels against a reference database

First make a database with statistics of each taxon is GTDB with make-ref-DB.sh <br/>
Usage:
```
sh make-ref-DB.sh <directory_where_you_download_GTDB>
```
Next use Genome_novelty.sh to calculate the novelty of your query genomes at each taxon level  <br/>
The input data for this script is the output results from https://github.com/Ecogenomics/GTDBTk with the first line removed and should look something like this:

```
SubAcS12-58     d__Bacteria;p__Actinobacteriota;c__Thermoleophilia;o__Gaiellales;f__Gaiellaceae;g__VAXT01;s__   N/A     N/A     N/A     N/A     N/A     GCA_005883245.1 95.0    d__Bacteria;p__Actinobacteriota;c__Thermoleophilia;o__Gaiellales;f__Gaiellaceae;g__VAXT01;s__VAXT01 sp005883245      85.67   0.74    d__Bacteria;p__Actinobacteriota;c__Thermoleophilia;o__Gaiellales;f__Gaiellaceae;g__;s__ taxonomic classification defined by topology and ANI    N/A     N/A     42.011       0.9613459588034069      Genome has more than 10.0% of markers with multiple hits
AcS16-58        d__Bacteria;p__Patescibacteria;c__Saccharimonadia;o__Saccharimonadales;f__UBA4665;g__UBA5150;s__        N/A     N/A     N/A     N/A     N/A     GCA_003133385.1 95.0    d__Bacteria;p__Patescibacteria;c__Saccharimonadia;o__Saccharimonadales;f__UBA4665;g__UBA5150;s__UBA5150 sp003133385  77.07   0.1     d__Bacteria;p__Patescibacteria;c__Saccharimonadia;o__Saccharimonadales;f__UBA4665;g__UBA5150;s__        taxonomic classification defined by topology and ANIN/A      GCA_002413795.1, s__UBA5150 sp002413795, 95.0, 77.64, 0.06; GCA_002792275.1, s__UBA5150 sp002792275, 95.0, 77.04, 0.05; GCA_003153395.1, s__UBA5150 sp003153395, 95.0, 76.81, 0.04      51.07   11      0.9388409759149751      N/A
NeS6-23 d__Bacteria;p__Chloroflexota;c__Ellin6529;o__CSP1-4;f__CSP1-4;g__SPCO01;s__     N/A     N/A     N/A     N/A     N/A     GCA_004525275.1 95.0    d__Bacteria;p__Chloroflexota;c__Ellin6529;o__CSP1-4;f__CSP1-4;g__SPCO01;s__SPCO01 sp004525275        76.72   0.17    d__Bacteria;p__Chloroflexota;c__Ellin6529;o__CSP1-4;f__CSP1-4;g__;s__   taxonomic classification defined by topology and ANI    N/A     N/A     31.77   11      0.8902817747312933      N/A
AcS7-114        d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__Rhizobiales;f__Beijerinckiaceae;g__Roseiarcus;s__       N/A     N/A     N/A     N/A     N/A     GCA_004799435.1 95.0    d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__Rhizobiales;f__Beijerinckiaceae;g__Roseiarcus;s__Roseiarcus sp004799435      82.95   0.71    d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__Rhizobiales;f__Beijerinckiaceae;g__Roseiarcus;s__       taxonomic classification defined by topology and ANI N/A     GCA_003164915.1, s__Roseiarcus sp003164915, 95.0, 81.65, 0.67; GCF_003315135.1, s__Roseiarcus fermentans, 95.0, 78.4, 0.53; GCA_003164825.1, s__Roseiarcus sp003164825, 95.0, 77.92, 0.4        71.0311      0.978688049034539       Genome not assigned to closest species as it falls outside its pre-defined ANI radius
AcS7-89 d__Bacteria;p__Patescibacteria;c__Paceibacteria;o__UBA9983;f__UBA2163;g__UBA10103;s__   N/A     N/A     N/A     N/A     N/A     GCA_001781335.1 95.0    d__Bacteria;p__Patescibacteria;c__Paceibacteria;o__UBA9983;f__UBA2163;g__UBA10103;s__UBA10103 sp001781335    76.92   0.15    d__Bacteria;p__Patescibacteria;c__Paceibacteria;o__UBA9983;f__UBA2163;g__UBA10103;s__   taxonomic classification defined by topology and ANI    N/A     GCA_001781175.1, s__UBA10103 sp001781175, 95.0, 77.06, 0.12; GCA_001004345.1, s__UBA10103 sp001004345, 95.0, 76.98, 0.12; GCA_003599295.1, s__UBA10103 sp003599295, 95.0, 76.91, 0.1; GCA_001781445.1, s__UBA10103 sp001781445, 95.0, 76.87, 0.11; GCA_001781105.1, s__UBA10103 sp001781105, 95.0, 76.74, 0.13; GCA_001781275.1, s__UBA10103 sp001781275, 95.0, 76.44, 0.09; GCA_003164215.1, s__UBA10103 sp003164215, 95.0, 76.42, 0.12; GCA_001783355.1, s__UBA10103 sp001783355, 95.0, 76.34, 0.05; GCA_001781555.1, s__UBA10103 sp001781555, 95.0, 76.29, 0.07; GCA_001781125.1, s__UBA10103 sp001781125, 95.0, 76.26, 0.14; GCA_003545515.1, s__UBA10103 sp003545515, 95.0, 76.2, 0.06; GCA_002773285.1, s__UBA10103 sp002773285, 95.0, 76.06, 0.09; GCA_003599175.1, s__UBA10103 sp003599175, 95.0, 76.04, 0.09; GCA_001781685.1, s__UBA10103 sp001781685, 95.0, 76.0, 0.07; GCA_001004265.1, s__UBA10103 sp001004265, 95.0, 75.77, 0.02; GCA_001783335.1, s__UBA10103 sp001783335, 95.0, 75.33, 0.03; GCA_001781465.1, s__UBA10103 sp001781465, 95.0, 74.63, 0.01 61.05   11      0.9450785553774059      N/A
AcS10-40        d__Bacteria;p__Actinobacteriota;c__Actinomycetia;o__Streptosporangiales;f__Streptosporangiaceae;g__Palsa-506;s__        N/A     N/A     N/A     N/A     N/A     GCA_003168215.1 95.0    d__Bacteria;p__Actinobacteriota;c__Actinomycetia;o__Streptosporangiales;f__Streptosporangiaceae;g__Palsa-506;s__Palsa-506 sp003168215        77.58   0.24    d__Bacteria;p__Actinobacteriota;c__Actinomycetia;o__Streptosporangiales;f__Streptosporangiaceae;g__;s__ taxonomic classification defined by topology and ANI N/A     N/A     66.96   11      0.927484425697193       N/A
SubAcS9-72      d__Bacteria;p__Actinobacteriota;c__Acidimicrobiia;o__Acidimicrobiales;f__RAAP-2;g__Bog-756;s__  N/A     N/A     N/A     N/A     N/A     N/A     N/A     N/A     N/A     N/A     d__Bacteria;p__Actinobacteriota;c__Acidimicrobiia;o__Acidimicrobiales;f__RAAP-2;g__Bog-756;s__       taxonomic classification defined by topology and ANI    N/A     GCA_003153575.1, s__Bog-756 sp003153575, 95.0, 81.22, 0.68; GCA_003164095.1, s__Bog-756 sp003164095, 95.0, 81.13, 0.72; GCA_003157945.1, s__Bog-756 sp003157945, 95.0, 80.37, 0.51; GCA_003138855.1, s__Bog-756 sp003138855, 95.0, 79.22, 0.52; GCA_003164275.1, s__Bog-756 sp003164275, 95.0, 77.38, 0.3    42.12   11      0.9427217581769116      Genome not assigned to closest species as it falls outside its pre-defined ANI radius
AcS14-31        d__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Burkholderiales;f__Burkholderiaceae;g__Rhizobacter;s__  N/A     N/A     N/A     N/A     N/A     GCA_003152055.1 95.0    d__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Burkholderiales;f__Burkholderiaceae;g__Rhizobacter;s__Rhizobacter sp003152055        83.85   0.73    d__Bacteria;p__Proteobacteria;c__Gammaproteobacteria;o__Burkholderiales;f__Burkholderiaceae;g__Rhizobacter;s__  taxonomic classification defined by topology and ANI N/A     GCF_001425865.1, s__Rhizobacter sp001425865, 95.0, 80.38, 0.62; GCF_000800095.1, s__Rhizobacter sp000800095, 95.0, 79.88, 0.55; GCF_900142965.1, s__Rhizobacter sp900142965, 95.0, 79.85, 0.56; GCF_000799605.1, s__Rhizobacter sp000799605, 95.0, 79.82, 0.57; GCA_005882155.1, s__Rhizobacter sp005882155, 95.0, 79.8, 0.47; GCF_001425825.1, s__Rhizobacter sp001425825, 95.0, 79.73, 0.56; GCA_001263235.1, s__Rhizobacter sp001263235, 95.0, 79.29, 0.48; GCF_003852895.1, s__Rhizobacter sp003852895, 95.0, 78.53, 0.46; GCF_002116905.1, s__Rhizobacter gummiphilus, 95.0, 78.47, 0.44; GCF_000799305.1, s__Rhizobacter sp000799305, 95.0, 78.47, 0.45; GCA_002255905.1, s__Rhizobacter sp002255905, 95.0, 78.45, 0.29; GCA_001464195.1, s__Rhizobacter sp001464195, 95.0, 78.17, 0.26; GCF_001425785.1, s__Rhizobacter sp001425785, 95.0, 78.16, 0.37; GCA_002281415.1, s__Rhizobacter sp002281415, 95.0, 77.92, 0.24  65.1411      0.9847180520894644      Genome not assigned to closest species as it falls outside its pre-defined ANI radius
AcS9-15 d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__UBA1301;f__UBA1301;g__UBA6038;s__       N/A     N/A     N/A     N/A     N/A     GCA_001896865.1 95.0    d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__UBA1301;f__UBA1301;g__UBA6038;s__UBA6038 sp001896865 80.56   0.49    d__Bacteria;p__Proteobacteria;c__Alphaproteobacteria;o__UBA1301;f__UBA1301;g__UBA6038;s__       taxonomic classification defined by topology and ANI    N/A     GCA_001898015.1, s__UBA6038 sp001898015, 95.0, 77.3, 0.19; GCA_003158585.1, s__UBA6038 sp003158585, 95.0, 77.12, 0.17; GCA_002307725.1, s__UBA6038 sp002307725, 95.0, 76.99, 0.16; GCA_002307315.1, s__UBA6038 sp002307315, 95.0, 76.92, 0.17; GCA_002429315.1, s__UBA6038 sp002429315, 95.0, 76.81, 0.15; GCA_003139615.1, s__UBA6038 sp003139615, 95.0, 76.62, 0.16; GCA_003131925.1, s__UBA6038 sp003131925, 95.0, 76.2, 0.08  64.15   11      0.9495404047755291      N/A
AcS13-74        d__Bacteria;p__Bacteroidota;c__Kapabacteria;o__Palsa-1295;f__Palsa-1295;g__PALSA-1295;s__       N/A     N/A     N/A     N/A     N/A     GCA_003151825.1 95.0    d__Bacteria;p__Bacteroidota;c__Kapabacteria;o__Palsa-1295;f__Palsa-1295;g__PALSA-1295;s__PALSA-1295 sp003151825      77.46   0.38    d__Bacteria;p__Bacteroidota;c__Kapabacteria;o__Palsa-1295;f__Palsa-1295;g__;s__ taxonomic classification defined by topology and ANI    N/A     N/A     48.81   11  0.8882616930588966       N/A
```
Usage:
```
sh MAG_Nov_tree.sh <input>
```
We have provided an example input file in "Example.input"
```
sh MAG_Nov_tree.sh Example.input
```
This generates the following output files: <br/>
**tax.novelty.50pcNovelty:** the number of genomes that have a genome novelty of equal or greater than 50% at phylum, class, order, family, genus and species level <br/>
**tax.novelty.75pcNovelty:** the number of genomes that have a genome novelty of equal or greater than 75% at phylum, class, order, family, genus and species level <br/>
**tax.novelty.stats:** Statistics of each taxonomic level identified in the dataset <br/>
**tax.novelty.nwk:** Newick format taxonomically stratified cladogram of input dataset, with genome novelty displayed on the branches <br/>

NOTE: Input data should be analysed with te same version of GTDB as the reference database, as GTDB taxonomic names can change between versions.
